# 10 â€“ PrÃ¡ce se soubory

## PrÃ¡ce se slovnÃ­ky

```python
slovnÃ­k = {}
print(1, slovnÃ­k)

slovnÃ­k[10] = 'deset'
slovnÃ­k['dvacet'] = 20
print(2, slovnÃ­k)

print(3, slovnÃ­k.keys())
for key in slovnÃ­k.keys():
  print(key)

print(4, slovnÃ­k.values())
for key in slovnÃ­k.values():
  print(key)

print(5, slovnÃ­k.items())
for item in slovnÃ­k.items():
  print(item)

print(6, slovnÃ­k['dvacet'])
# print(6, slovnÃ­k['tÅ™icet']) # KeyError
print(6, slovnÃ­k.get('tÅ™icet'))
print(6, slovnÃ­k.get('tÅ™icet', 30))

print(7, slovnÃ­k.get(10))
print(7, slovnÃ­k.pop(10))
# print(7, slovnÃ­k.pop(10)) # KeyError
print(7, slovnÃ­k.get(10))

print(8, 'dvacet' in slovnÃ­k)
print(8, 10 in slovnÃ­k)
```

## PrÃ¡ce se soubory

> PÅ™Ã­prava: nahrajte si soubor `PepaNos.txt` do adresÃ¡Å™e souborÅ¯ na Colab.

Soubor otevÅ™ete pro ÄtenÃ­, pÅ™eÄtete obsah a obsah vypÃ­Å¡ete (mode='r'):

```python
soubor = open('PepaNos.txt', 'r') # deskriptor
obsah = soubor.read()             # datovÃ½ proud
soubor.close()
obsah # Å™etÄ›zec s konci Å™Ã¡dkÅ¯ \n
```

PomocÃ­ klauzule `with` (tzv. kontextovÃ½ sprÃ¡vce, context manager) zajistÃ­te, Å¾e soubor se automaticky zavÅ™e, dokonce i kdyÅ¾ nastane vÃ½jimka:

```python
with open('PepaNos.txt', 'r') as soubor:
  obsah = soubor.read()
print(obsah)
```

Co se stane, kdyÅ¾ soubor neexistuje?

```python
with open('NeznÃ¡mÃ½.txt', 'r') as soubor:
  obsah = soubor.read()
print(obsah)
```

OÅ¡etÅ™enÃ­ vÃ½jimky:

```python
try:
  with open('NeznÃ¡mÃ½.txt', 'r') as soubor:
    obsah = soubor.read()
except FileNotFoundError:
  obsah = '???'

print(obsah)
```

Soubor lze pÅ™eÄÃ­st jako seznam Å™Ã¡dkÅ¯:

```python
with open('PepaNos.txt', 'r') as soubor:
  obsah = soubor.readlines()
print(obsah)
```

KoncovÃ© znaky Å™Ã¡dek `\n` (nebo lÃ©pe Å™eÄeno: bÃ­lÃ¡ mÃ­sta na konci Å™Ã¡dek) lze odstranit:

```python
with open('PepaNos.txt', 'r') as soubor:
  obsah = [line.rstrip() for line in soubor.readlines()]
print(obsah)
```

PÅ™i zÃ¡pisu do souboru (mode='w') se soubor buÄ vytvoÅ™Ã­, nebo pÅ™epÃ­Å¡e:

```python
with open('NovÃ½.txt', 'w') as soubor:
  soubor.write('prvnÃ­ Å™Ã¡dka\n')
  soubor.write('druhÃ¡ Å™Ã¡dka\n')
```

Nebo jako seznak Å™Ã¡dek:

```python
with open('NovÃ½.txt', 'w') as soubor:
  soubor.writelines([
    'prvnÃ­ Å™Ã¡dka\n',
    'druhÃ¡ Å™Ã¡dka\n'
  ])
```

NovÃ½ soubor lze pak pÅ™eÄÃ­st:

```python
with open('NovÃ½.txt', 'r') as soubor:
  print(soubor.read())
```

Do existujÃ­cÃ­ho souboru lze pÅ™ipisovat (zapisovat na konec):

```python
with open('NovÃ½.txt', 'a') as soubor:
  soubor.write('tÅ™etÃ­ Å™Ã¡dka\n')
```

Soubory lze otevÃ­rat (`open()`) i v jinÃ½ch mÃ³dech (reÅ¾imech):

```python
help(open) # pÅ™eÄtÄ›te si dokumentaci
```

Pozici pro ÄtenÃ­/zÃ¡pis v souboru (ÄtecÃ­/zÃ¡pisovÃ¡ "hlava") lze zÃ­skat i nastavit. Do souboru lze tak zapisovat i ÄÃ­st na libovolnÃ©m mÃ­stÄ›:

```python
with open('abc.txt', 'w+') as file:
  print('1.', file.tell())
  file.write('abcdefghijklmnopqrstuvwxyz')
  print('2.', file.tell())
  file.seek(0) # rewind
  print('3.', file.tell())

  while True:
    print(file.tell(), end=' ')
    char = file.read(1)
    if not char: break # empty string (read beyond the file end)
    print(char)

  file.seek(20)
  file.write('XXX')
  file.seek(0)
  print(file.read())
```

```python
help(file.seek) # pÅ™eÄtÄ›te si dokumentaci
```

DÃ©lku souboru lze zjistit takÃ© pomocÃ­ metody `tell()`:

```python
with open('abc.txt', 'r') as file:
  file.seek(0, 2)
  print('length:', file.tell())
```

nebo systÃ©movou funkcÃ­:

```python
import os
print('length:', os.path.getsize('abc.txt'))
```

### ShrnutÃ­ mÃ³dÅ¯:

| mÃ³d | popis                      |
| --- | -------------------------- |
| r   | ÄtenÃ­                      |
| w   | zÃ¡pis (pÅ™episuje)          |
| a   | pÅ™Ã­pis                     |
| r+  | ÄtenÃ­ a zÃ¡pis (na zaÄÃ¡tku) |
| w+  | ÄtenÃ­ a zÃ¡pis (pÅ™episuje)  |
| a+  | ÄtenÃ­ a zÃ¡pis (na konci)   |

### ğŸ“± Ãšloha:

VezmÄ›me slovnÃ­k, kterÃ½ obsahuje seznamy znÃ¡mek studentÅ¯ (z dÅ™Ã­vÄ›jÅ¡Ã­ho cviÄenÃ­).

```python
znÃ¡mky = {
  'Adam': [1,1,2,1,3,5],
  'Nela': [1,4,2,1,1,2],
  'Zuzi': [1,1,1,1,1,2],
}
```

ZapiÅ¡te tato data do [CSV](https://cs.wikipedia.org/wiki/CSV) souboru `znÃ¡mky.csv`. KaÅ¾dÃ½ Å™Ã¡dek bude obsahovat jmÃ©no studenta a jeho znÃ¡mky oddÄ›lenÃ© ÄÃ¡rkou, takto:

```
JmÃ©no,z1,z2,z3,z4,z5,z6
Adam,1,1,2,1,3,5
Nela,1,4,2,1,1,2
Zuzi,1,1,1,1,1,2
```

### ğŸ“± Ãšloha:

NaÄtÄ›te znÃ¡mky ze souboru `znÃ¡mky.csv`, uloÅ¾te je do slovnÃ­ku a vypiÅ¡te je na obrazovku.

### ğŸ“± Ãšloha:

NapiÅ¡te funkci, kterÃ¡ naÄte prvnÃ­ch `n` Å™Ã¡dkÅ¯ ze souboru `file` (napÅ™. `PepaNos.txt`) a vrÃ¡tÃ­ je jako seznam Å™Ã¡dkÅ¯.

```python
def head(file:str, n=10) -> list[str]
  ...

print(head('PepaNos.txt', 3))
```

### ğŸ“± Ãšloha:

NapiÅ¡te funkci, kterÃ© je obdobou pÅ™Ã­kazu [`wc`](https://www.geeksforgeeks.org/wc-command-linux-examples/) (word count) v Linuxu: pÅ™eÄte soubor a vrÃ¡tÃ­ poÄet Å™Ã¡dkÅ¯, poÄet slov a poÄet znakÅ¯ v souboru.

```python
def wc(file:str) -> tuple[int,int,int]:
  nl = 0; nw = 0; nc = 0
  ...
  return (nl, nw, nc)

print(wc('PepaNos.txt'))
```

### ğŸ“± Ãšloha:

PÅ™eÄtÄ›te soubor `PepaNos.txt`. Obsah zapiÅ¡te do souboru `PepaNos-obrÃ¡cenÄ›.txt` tak, aby byl zapsÃ¡n obrÃ¡cenÄ› (poslednÃ­ Å™Ã¡dek jako prvnÃ­, pÅ™edposlednÃ­ jako druhÃ½, atd.).

### ğŸ“± Ãšloha:

PÅ™eÄtÄ›te soubor `PepaNos.txt`. Obsah zapiÅ¡te do souboru `PepaNos-ÄÃ­slovÃ¡no.txt` tak, aby kaÅ¾dÃ½ Å™Ã¡dek v novÃ©m souboru obsahoval ÄÃ­slo Å™Ã¡dku a text oddÄ›lenÃ½ teÄkou. Text Å™Ã¡dek, kterÃ© se v souboru opakujÃ­, zapiÅ¡te jen jednou, pÅ™i prvnÃ­m vÃ½skytu. DalÅ¡Ã­ vÃ½skyty zapiÅ¡te jako `== (X) == `, kde `X` je ÄÃ­slo Å™Ã¡dky s prvnÃ­m opakovÃ¡nÃ­m.

### ğŸ“± Ãšloha:

NapiÅ¡te funkci, kterÃ¡ naÄte soubor `PepaNos.txt` a vrÃ¡tÃ­ slovnÃ­k, kde klÃ­Äem je slovo a hodnotou je poÄet vÃ½skytÅ¯ tohoto slova v souboru.

```python
def wordCount(file:str) -> dict[str,int]:
  ...

print(wordCount('PepaNos.txt'))
```

DÃ¡le:

- vypiÅ¡te slova a jejich poÄty seÅ™azenÃ© podle a) abecedy, b) poÄtu vÃ½skytÅ¯
- pomocÃ­ knihovny `matplotlib` vykreslete sloupcovÃ½ graf, kterÃ½ zobrazÃ­ 10 nejÄastÄ›jÅ¡Ã­ch slov

# BinÃ¡rnÃ­ soubory

PÅ™Ã­znakem `b` je moÅ¾no pracovat se souborem tzv. binÃ¡rnÄ›, tj. bajt po bajtu:

| mÃ³d | popis                      |
| --- | -------------------------- |
| rb  | ÄtenÃ­ binÃ¡rnÃ­ch dat        |
| wb  | zÃ¡pis                      |
| ab  | pÅ™Ã­pis                     |
| rb+ | ÄtenÃ­ a zÃ¡pis (na zaÄÃ¡tku) |
| wb+ | ÄtenÃ­ a zÃ¡pis (pÅ™episuje)  |
| ab+ | ÄtenÃ­ a zÃ¡pis (na konci)   |

Mohli bychom si napÅ™. vytvoÅ™it soubor pro uloÅ¾enÃ­ obrÃ¡zku, v naÅ¡em vlastnÃ­m nestandardnÃ­m binÃ¡rnÃ­m formÃ¡tu.

NejdÅ™Ã­ve obrÃ¡zek vytvoÅ™Ã­me, zobrazÃ­me a zapÃ­Å¡eme data do souboru:

```python
from PIL import Image

w = 60
h = 48

img = Image.new('RGB', (w,h))

for x in range(w):
  for y in range(h):
    img.putpixel((x,y), (x*4,0,255-x*3))

display(img)

with open('img.bin', 'wb') as file:
  file.write(bytes([w, h]))
  for x in range(w):
    for y in range(h):
      r,g,b = img.getpixel((x,y))
      file.write(bytes([r,g,b]))
```

ObrÃ¡zek pak mÅ¯Å¾eme naÄÃ­st zpÄ›t:

```python
with open('img.bin', 'rb') as file:
  w = file.read(1)[0]
  h = file.read(1)[0]
  img = Image.new('RGB', (w,h))
  for x in range(w):
    for y in range(h):
      r = file.read(1)[0]
      g = file.read(1)[0]
      b = file.read(1)[0]
      img.putpixel((x,y), (r,g,b))

display(img)
```

### ğŸ“± Ãšloha:

Upravte kÃ³d pro uklÃ¡dÃ¡nÃ­ a ÄtenÃ­ obrÃ¡zku tak, aby bylo moÅ¾nÃ© uloÅ¾it a naÄÃ­st i obrÃ¡zek vÄ›tÅ¡Ã­ neÅ¾ 255Ã—255 pixelÅ¯.

# DalÅ¡Ã­ materiÃ¡ly

ProjdÄ›te si takÃ©:

## [PB10](https://github.com/pavelberanek91/UJEP/blob/main/APR1/Cvi%C4%8Den%C3%AD%2010/README.md)
